#
# DETECT UNREACHABLE HOSTS
#

- hosts: all
  name: unreachable
  gather_facts: no
  ignore_unreachable: yes
  tasks:
    - block:
        - name: detect unreachable hosts
          wait_for_connection:
            timeout: 3
      rescue:
        - name: add unreachable hosts to inventory group
          group_by:
            key: '{{ unreachable_hosts_group|default("unreachable") }}'
          changed_when: no
