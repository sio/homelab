---
- hosts: all
  name: verify
  tasks:
    - name: hello world
      command: echo hello
      register: hello
      failed_when: "'hello' not in hello.stdout"
      changed_when: "hello is not succeeded"

    - name: read apt source files
      shell: tail -v -n+0 /etc/apt/sources.list.d/*
      register: sources

    - name: show apt source files
      debug:
        msg: '{{ sources.stdout }}'

    - name: search for packages from new repos
      shell: |-
        set -euo pipefail
        apt-cache show {{ item|quote }} | head -n25
      args:
        executable: /bin/bash
      loop:
        - google-chrome-stable
        - gitlab-runner
        - bsdgames-nonfree
      register: apt_search

    - name: show search results
      debug:
        msg: '{{ apt_search|to_nice_yaml }}'

    - name: ping
      ping:
