---

- hosts: all
  become: true
  vars:
    server_keys_public:
      - '{{ molecule_ephemeral_directory }}/testkey.pub'
    transmission_instance:
      name: main
      port: 51001
      port_rpc: 9001
      override:
        upload_limit: 200
      watch:
        - name: main
          torrents: /storage/torrents/
          destination: /storage/data/
          extras: --seedratio 2
  pre_tasks:
    - include: ../../../../tasks/unattended-purge.yml
  roles:
    - role: deb_url
      deb_url_packages:
        - url: https://github.com/sio/transmission-debian-patched/releases/download/2.94-2.1-buster/transmission-common_2.94-2.1_all.deb
          checksum: sha256:42117eaac71af8fa53b5b0803df986adcd0d3bdaf0a7f0791465f7b2478ad765
        - url: https://github.com/sio/transmission-debian-patched/releases/download/2.94-2.1-buster/transmission-cli_2.94-2.1_amd64.deb
          checksum: sha256:35efc0c6f2576ac7cce5fea5fc1ad88e46e197041af0e9b460c4d2c051c22265
        - url: https://github.com/sio/transmission-debian-patched/releases/download/2.94-2.1-buster/transmission-daemon_2.94-2.1_amd64.deb
          checksum: sha256:ad651ef56c279ca84a827fd112544127fbb6b73e1b8a4c7cd902b94132b34ab7
    - role: transmission
