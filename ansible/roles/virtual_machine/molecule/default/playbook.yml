---

- hosts: all
  become: true
  vars_files:
    - ../../../../group_vars/all.yml
  vars:
    qcow2_image: '/guest-image.qcow2'
  roles:
    - role: kvm_bridge
      kvm_bridge_fallback_iface: inet static
      kvm_bridge_options:
        address: '{{ ansible_default_ipv4.address }}'
        gateway:  '{{ ansible_default_ipv4.gateway }}'
        bridge_stp: 'off'
        bridge_maxwait: 0
        bridge_fd: 0
    - role: virtual_machine
      virtual_machine_image: '{{ qcow2_image }}'
      virtual_machine_image_url: '{{ vm_image_debian10 }}'
      virtual_machine_image_checksum: 'sha256:{{ vm_image_debian10_checksum }}'
