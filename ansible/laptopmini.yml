#
# Hardware-related configuration for Asus laptop (UL80 aka laptopmini)
#

---
- hosts: laptopmini
  become: yes
  roles:
    - role: upgrade
    - role: packages
      packages_install:
        # Desktop apps
        - smplayer
        - transgui
        - audacious

        # Desktop environment
        - task-xfce-desktop
        - fonts-cantarell
        - numix-gtk-theme
        - xclip
        # xfwm4-themes   # Removed from Buster repos
        - gvfs-backends  # Android file transfer over USB
        - rar
        - unrar

        # Interactive shell
        - git
        - make
        - tmux
        - vim-gtk3  # GUI build has more stuff enabled at compile time

        # System administration
        - psmisc
        - smartmontools

        # Hardware support
        - firmware-linux
        - firmware-linux-free
        - firmware-linux-nonfree

        # Laptop optimisation
        - acpi-support
        - cpufrequtils
        - tlp
        - tlp-rdw

    - role: interactive
      interactive_user: user

    - role: munin_node
      munin_master_cidr: 192.168.28.10/32

    - role: grub
      grub_kernel_params:
        - quiet
        - splash
        - zswap.enabled=1
        - zswap.compressor=lz4
        - zswap.zpool=z3fold
        - zswap.max_pool_percent=40
    - role: initrd  # Intel kernel modesetting in initramfs
      modules:
        - intel_agp
        - drm
        - i915 modeset=1
    - role: initrd  # Enable zswap
      modules:
        - lz4
        - lz4_compress
        - z3fold
